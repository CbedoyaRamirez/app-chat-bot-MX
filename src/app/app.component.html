<div class="app-container">
  <!-- Bot Selector UI - shown when chat is not open -->
  <div class="bot-selector" *ngIf="!isChatOpen">
    <div class="selector-container">
      <div class="selector-header">
        <img src="assets/chubb-logo.svg" alt="Chubb" class="logo" />
        <h1>POC Digital Transformation</h1>
      </div>
      <h2>¿Qué necesitas hoy?</h2>
      <p class="selector-description">
        Selecciona el asistente que mejor se adapte a tus necesidades
      </p>

      <div class="bot-options">
        <button
          class="bot-option"
          [class.active]="currentBotType === BotType.QUOTE_AUTO"
          (click)="switchBot(BotType.QUOTE_AUTO)">
          <div class="icon">
            <img src="assets/icons/car_clean.svg" alt="Auto" />
          </div>
          <h3>Cotización Auto</h3>
          <p>Obtén una cotización personalizada para tu seguro de auto</p>
        </button>

        <button
          class="bot-option"
          [class.active]="currentBotType === BotType.FAQ"
          (click)="switchBot(BotType.FAQ)">
          <div class="icon">
            <img src="assets/icons/Chat-bubble-fill.svg" alt="Chat" />
          </div>
          <h3>Preguntas Frecuentes</h3>
          <p>Consulta sobre pólizas, coberturas y más información</p>
        </button>
      </div>

      <div class="selector-footer">
        <p>Haz clic en una opción para comenzar</p>
      </div>
    </div>
  </div>

  <!-- Header - shown when chat is open -->
  <header class="app-header" *ngIf="isChatOpen">
    <div class="header-content">
      <img src="assets/chubb-logo.svg" alt="Chubb" class="logo" />
      <h1>{{ title }}</h1>
    </div>
  </header>


  <!-- Chat Window -->
  <app-chat-window
    *ngIf="isChatOpen"
    [theme]="theme"
    [showAvatar]="true"
    [avatarUrl]="avatarUrl"
    [title]="'Asistente Chubb'"
    [modalConfig]="modalConfig"
    [enableTimeStamp]="enableTimeStamp"
    [enableMicrophone]="enableMicrophone"
    [isTyping]="isTyping"
    [messages]="messages"
    [errorState]="errorState"
    [timeStampHelperMessage]="timeStampHelperMessage"
    [transferNotifyMessage]="transferNotifyMessage"
    (handleBotMessage)="onHandleMessage($event)"
    (microphoneClick)="onHandleMicrophone()"
    (minimizeChat)="onMinimizeChat($event)"
    (closeChat)="onCloseChat($event)"
    (handleTranscript)="onHandleTranscript($event)"
    (secondaryModalbutton)="onHandleSecondaryButton($event)"
  ></app-chat-window>

  <!-- Recording Indicator -->
  <div class="recording-indicator" *ngIf="isRecording">
    <div class="recording-dot"></div>
    <span>Grabando audio...</span>
  </div>

  <!-- Inactivity Warning Modal -->
  <div class="inactivity-modal-overlay" *ngIf="showInactivityWarning && isChatOpen" (click)="keepChatActive()">
    <div class="inactivity-modal" (click)="$event.stopPropagation()">
      <div class="modal-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#FF6B00" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
      </div>
      <h3 class="modal-title">¿Sigues ahí?</h3>
      <p class="modal-message">
        No hemos detectado actividad en un tiempo. El chat se cerrará automáticamente en:
      </p>
      <div class="countdown-timer">
        <span class="countdown-number">{{ inactivityCountdown }}</span>
        <span class="countdown-label">segundos</span>
      </div>
      <div class="modal-actions">
        <button class="btn-primary" (click)="keepChatActive()" type="button">
          Continuar conversación
        </button>
      </div>
    </div>
  </div>
</div>
